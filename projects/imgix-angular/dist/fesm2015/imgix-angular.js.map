{"version":3,"file":"imgix-angular.js","sources":["../../src/lib/imgix-config.service.ts","../../src/common/constants.ts","../../src/common/createImgixClient.ts","../../src/common/ng.ts","../../src/lib/ix-img.component.ts","../../src/lib/ix-picture.component.ts","../../src/lib/ix-source.component.ts","../../src/lib/imgix-angular.module.ts","../../src/public-api.ts","../../src/imgix-angular.ts"],"sourcesContent":["import { InjectionToken } from '@angular/core';\nimport { IImgixParams } from './types';\n\nexport interface ImgixConfig {\n  domain: string;\n  includeLibraryParam?: boolean;\n  defaultImgixParams?: IImgixParams;\n}\n\nexport const ImgixConfigService = new InjectionToken<ImgixConfig>(\n  'ImgixConfig',\n);\n","export const IMGIX_NG_VERSION: string = '1.0.0-rc.1';\n","import ImgixClient from 'imgix-core-js';\nimport { ImgixConfig } from '../lib/imgix-config.service';\nimport { IMGIX_NG_VERSION } from './constants';\n\nexport function createImgixClient(config: ImgixConfig): ImgixClient {\n  const client = new ImgixClient({\n    domain: config.domain,\n    includeLibraryParam: false,\n  });\n\n  if (!(config.includeLibraryParam === false)) {\n    (client as any).settings.libraryParam = `ng-${IMGIX_NG_VERSION}`;\n  }\n\n  return client;\n}\n","/** Coerces a data-bound value (typically a string) to a boolean. */\nexport function coerceBooleanProperty(value: any): boolean {\n  return value != null && `${value}` !== 'false';\n}\n\nexport function coerceNumericProperty(value: any): number | undefined {\n  if (typeof value === 'string') {\n    const valueParsed = Number.parseFloat(value);\n    if (!Number.isNaN(valueParsed)) {\n      return valueParsed;\n    }\n  } else if (typeof value === 'number' && !Number.isNaN(value)) {\n    return value;\n  }\n\n  return undefined;\n}\n","import {\n  AfterViewChecked,\n  Component,\n  ElementRef,\n  Inject,\n  Injectable,\n  Input,\n} from '@angular/core';\nimport ImgixClient from 'imgix-core-js';\nimport { createImgixClient } from '../common/createImgixClient';\nimport { coerceBooleanProperty, coerceNumericProperty } from '../common/ng';\nimport { ImgixConfig, ImgixConfigService } from './imgix-config.service';\nimport { IImgixParams } from './types';\n\n@Injectable()\n@Component({\n  // the [path] means that path is required\n  selector: '[ixImg][path]',\n  template: ``,\n})\nexport class IxImgComponent implements AfterViewChecked {\n  private readonly client: ImgixClient;\n\n  @Input('path') path: string;\n  @Input()\n  get fixed(): boolean {\n    return this._fixed;\n  }\n  set fixed(value: boolean) {\n    this._fixed = coerceBooleanProperty(value as any);\n  }\n  private _fixed: boolean = false;\n\n  @Input('imgixParams') imgixParams?: IImgixParams;\n\n  @Input('width')\n  get width(): number | undefined {\n    return this._width;\n  }\n  set width(_width: number | undefined) {\n    this._width = coerceNumericProperty(_width);\n  }\n  private _width: number | undefined;\n\n  @Input()\n  get height(): number | undefined {\n    return this._height;\n  }\n  set height(_height: number | undefined) {\n    this._height = coerceNumericProperty(_height);\n  }\n  private _height: number | undefined;\n\n  @Input() attributeConfig?: { src?: string; srcset?: string };\n  @Input()\n  get disableVariableQuality(): boolean {\n    return this._disableVariableQuality;\n  }\n  set disableVariableQuality(_disableVariableQuality: boolean) {\n    this._disableVariableQuality = coerceBooleanProperty(\n      _disableVariableQuality,\n    );\n  }\n  private _disableVariableQuality: boolean = false;\n\n  constructor(\n    @Inject(ImgixConfigService) private config: ImgixConfig,\n    private elementRef: ElementRef<HTMLImageElement>,\n  ) {\n    this.client = createImgixClient(this.config);\n  }\n\n  ngAfterViewChecked() {\n    this.setSrcAndSrcsetAttributes();\n    this.setOtherAttributes();\n  }\n\n  private setOtherAttributes() {\n    const el = this.elementRef.nativeElement;\n    if (this.width != null) {\n      el.setAttribute('width', String(this.width));\n    }\n    if (this.height != null) {\n      el.setAttribute('height', String(this.height));\n    }\n  }\n\n  private buildIxParams() {\n    const imgixParamsFromImgAttributes = {\n      ...(this.fixed && {\n        ...(this.width != null ? { w: this.width } : {}),\n        ...(this.height != null ? { h: this.height } : {}),\n      }),\n    };\n    return {\n      ...this.config.defaultImgixParams,\n      ...imgixParamsFromImgAttributes,\n      ...this.imgixParams,\n    };\n  }\n\n  private setSrcAndSrcsetAttributes() {\n    const el = this.elementRef.nativeElement;\n    el.setAttribute(this.attributeConfig?.src ?? 'src', this.srcURL);\n    el.setAttribute(this.attributeConfig?.srcset ?? 'srcset', this.srcsetURL);\n  }\n\n  get srcURL(): string {\n    return this.client.buildURL(this.path, this.buildIxParams());\n  }\n  get srcsetURL(): string {\n    return this.client.buildSrcSet(this.path, this.buildIxParams(), {\n      disableVariableQuality: this.disableVariableQuality,\n    });\n  }\n}\n","import { Component, Injectable } from '@angular/core';\n\n@Injectable()\n@Component({\n  selector: '[ixPicture]',\n  template: '<ng-content></ng-content>',\n})\nexport class IxPictureComponent {}\n","import {\n  AfterViewChecked,\n  Component,\n  ElementRef,\n  Inject,\n  Injectable,\n  Input,\n} from '@angular/core';\nimport ImgixClient from 'imgix-core-js';\nimport { createImgixClient } from '../common/createImgixClient';\nimport { coerceBooleanProperty } from '../common/ng';\nimport { ImgixConfig, ImgixConfigService } from './imgix-config.service';\nimport { IImgixParams } from './types';\n\n@Injectable()\n@Component({\n  // the [path] means that path is required\n  selector: '[ixSource][path]',\n  template: ``,\n})\nexport class IxSourceComponent implements AfterViewChecked {\n  private readonly client: ImgixClient;\n\n  @Input('path') path: string;\n  @Input() imgixParams?: IImgixParams;\n  @Input() attributeConfig?: { srcset?: string };\n  @Input()\n  get disableVariableQuality(): boolean {\n    return this._disableVariableQuality;\n  }\n  set disableVariableQuality(_disableVariableQuality: boolean) {\n    this._disableVariableQuality = coerceBooleanProperty(\n      _disableVariableQuality,\n    );\n  }\n  private _disableVariableQuality: boolean = false;\n\n  constructor(\n    @Inject(ImgixConfigService) private config: ImgixConfig,\n    private elementRef: ElementRef,\n  ) {\n    this.client = createImgixClient(config);\n  }\n\n  ngAfterViewChecked() {\n    this.setSrcsetAttribute();\n  }\n  private buildIxParams() {\n    const imgixParamsFromImgAttributes = {};\n    return {\n      ...this.config.defaultImgixParams,\n      ...imgixParamsFromImgAttributes,\n      ...this.imgixParams,\n    };\n  }\n  private setSrcsetAttribute() {\n    const el = this.elementRef.nativeElement;\n    el.setAttribute(this.attributeConfig?.srcset ?? 'srcset', this.srcsetURL);\n  }\n  get srcsetURL(): string {\n    return this.client.buildSrcSet(this.path, this.buildIxParams(), {\n      disableVariableQuality: this.disableVariableQuality,\n    });\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { ImgixConfig, ImgixConfigService } from './imgix-config.service';\nimport { IxImgComponent } from './ix-img.component';\nimport { IxPictureComponent } from './ix-picture.component';\nimport { IxSourceComponent } from './ix-source.component';\n\n@NgModule({\n  declarations: [IxImgComponent, IxSourceComponent, IxPictureComponent],\n  exports: [IxImgComponent, IxSourceComponent, IxPictureComponent],\n})\nexport class ImgixAngularModule {\n  // Using config injection pattern from: https://medium.com/@michelestieven/angular-writing-configurable-modules-69e6ea23ea42\n  static forRoot(config: ImgixConfig): ModuleWithProviders<ImgixAngularModule> {\n    return {\n      ngModule: ImgixAngularModule,\n      providers: [\n        IxImgComponent,\n        IxSourceComponent,\n        IxPictureComponent,\n        { provide: ImgixConfigService, useValue: config },\n      ],\n    };\n  }\n}\n","/*\n * Public API Surface of imgix-angular\n */\n\nexport * from './lib/imgix-angular.module';\nexport * from './lib/ix-img.component';\nexport * from './lib/ix-picture.component';\nexport * from './lib/ix-source.component';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {ImgixConfig as ɵa,ImgixConfigService as ɵb} from './lib/imgix-config.service';"],"names":[],"mappings":"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"}